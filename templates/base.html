{% import "macros.html" as lib %}
{# Retreive configuration variables #}
{% block config %}
{% endblock config %}
{# Retreive site index with proper language #}
{% if lang == config.default_language %}
  {% set index = get_section(path="_index.md", metadata_only=true) %}
{% else %}
  {% set index = get_section(path="_index."~lang~".md", metadata_only=true) %}
{% endif %}
{# Retreive template translations #}
{% set i18n_data = load_data(path="data/i18n.yml", required=false) %}
{% if not i18n_data %}
  {% set i18n_data = load_data(path=config.extra.path~"/data/i18n.yml") %}
{% endif %}
{% set i18n = i18n_data[lang] %}
{# Retreive predefined icons #}
{% set icons = load_data(path="data/icon.yml", required=false) %}
{% if not icons %}
  {% set icons = load_data(path=config.extra.path~"/data/icon.yml") %}
{% endif %}
{# Set fallback description #}
{% if not description %}
  {% set description = config.description %}
{% endif %}
{# The actual page #}
<!DOCTYPE html>
<html lang="{{ lang }}">
  <head>
    {% block head_prepend %}
    {% endblock head_prepend %}
    {% include "head.html" %}
    {% block head_append %}
    {% endblock head_append %}
  </head>
  <body id="top">
    {% block body_prepend %}
    {% endblock body_prepend %}
    <header>
      {% block header_prepend %}
      {% endblock header_prepend %}
      {% include "header.html" %}
      {% block header_append %}
      {% endblock header_append %}
    </header>
    <nav aria-label="{{ i18n.nav }}">
      {% block nav_prepend %}
      {% endblock nav_prepend %}
      {% include "nav.html" %}
      {% block nav_append %}
      {% endblock nav_append %}
    </nav>
    <main>
      {% block main_prepend %}
      {% endblock main_prepend %}
      {% block main %}
      {% endblock main %}
      {% block main_append %}
      {% endblock main_append %}
    </main>
    <footer>
      {% block footer_prepend %}
      {% endblock footer_prepend %}
      {% include "footer.html" %}
      {% block footer_append %}
      {% endblock footer_append %}
    </footer>
    {% block body_append %}
      {{ lib::return_top(label=i18n.return_top) }}
    {% endblock body_append %}
  </body>
</html>
