{% if src is starting_with("http") %}
  {# " #}
  {% set width = w | default(value="1920") %}
  {% set height = h | default(value="1080") %}
  <img width="{{ width }}"
       height="{{ height }}"
       alt="{{ alt }}"
       src="{{ src }}"
       class="{{ class | default(value='') }}">
{% elif config.extra.auto_img %}
  {# set format = src | split(pat=".") | slice(start=-1) #}
  {% set meta = get_image_metadata(path=src, allow_missing=true) %}
  {% if not meta %}
    {% if page %}
      {% set path = page.path %}
    {% elif section %}
      {% set path = section.path %}
    {% endif %}
    {% if lang != config.default_language %}
      {% set src = path ~ src | replace(from=path | truncate(length=4, end=""), to="/") %}
    {% else %}
      {% set src = path ~ src %}
    {% endif %}
    {% set meta = get_image_metadata(path=src) %}
  {% endif %}
  {% set width = w | default(value=meta.width) %}
  {% set height = h | default(value=meta.height) %}
  {% if meta.format == "webp" %}
    {% set default = resize_image(path=src, width=width, height=height) %}
  {% else %}
    {% set default = resize_image(path=src, width=width, height=height) %}
    {% set webp = resize_image(path=src, width=width, height=height, format="webp") %}
  {% endif %}
  <picture>
    <source srcset="{{ webp.url | default(value=src) | safe }}" type="image/webp">
    <img width="{{ width }}"
         height="{{ height }}"
         alt="{{ alt }}"
         src="{{ default.url }}"
         class="{{ class | default(value='') }}">
  </picture>
{% endif %}
